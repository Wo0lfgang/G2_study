!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@antv/g-lite")):"function"==typeof define&&define.amd?define(["exports","@antv/g-lite"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).G=e.G||{},e.G.DOMMutationObserverAPI={}),e.window.G)}(this,(function(e,t){"use strict";var i,r,n=function(){function e(e,t){this.type=void 0,this.target=void 0,this.addedNodes=[],this.attributeName=null,this.attributeNamespace=null,this.nextSibling=null,this.oldValue=null,this.previousSibling=null,this.removedNodes=[],this.type=e,this.target=t}return e.copy=function(t){var i=new e(t.type,t.target);return i.addedNodes=t.addedNodes.slice(),i.removedNodes=t.removedNodes.slice(),i.previousSibling=t.previousSibling,i.nextSibling=t.nextSibling,i.attributeName=t.attributeName,i.attributeNamespace=t.attributeNamespace,i.oldValue=t.oldValue,i},e}(),s=0,a=new WeakMap,o=function(){function e(e,t,i){this.observer=void 0,this.target=void 0,this.options=void 0,this.transientObservedNodes=[],this.observer=e,this.target=t,this.options=i}var s=e.prototype;return s.enqueue=function(e){var n=this.observer.records,s=n.length;if(n.length>0){var a=function(e,t){return e===t?e:r&&function(e){return e===r||e===i}(e)?r:null}(n[s-1],e);if(a)return void(n[s-1]=a)}else v.push(this.observer),l||(l=!0,void 0!==t.runtime.globalThis?t.runtime.globalThis.setTimeout(c):c());n[s]=e},s.addListeners=function(){this.addListeners_(this.target)},s.addListeners_=function(e){var i=this.options;i.attributes&&e.addEventListener(t.ElementEvent.ATTR_MODIFIED,this,!0),i.childList&&e.addEventListener(t.ElementEvent.INSERTED,this,!0),(i.childList||i.subtree)&&e.addEventListener(t.ElementEvent.REMOVED,this,!0)},s.removeListeners=function(){this.removeListeners_(this.target)},s.removeListeners_=function(e){var i=this.options;i.attributes&&e.removeEventListener(t.ElementEvent.ATTR_MODIFIED,this,!0),i.childList&&e.removeEventListener(t.ElementEvent.INSERTED,this,!0),(i.childList||i.subtree)&&e.removeEventListener(t.ElementEvent.REMOVED,this,!0)},s.removeTransientObservers=function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach((function(e){this.removeListeners_(e);for(var t=a.get(e),i=0;t.length>i;i++)if(t[i]===this){t.splice(i,1);break}}),this)},s.handleEvent=function(e){var s,a;switch(e.stopImmediatePropagation(),e.type){case t.ElementEvent.ATTR_MODIFIED:var o=e.attrName,l=e.relatedNode.namespaceURI;(s=u("attributes",a=e.target)).attributeName=o,s.attributeNamespace=l;var v=e.attrChange===t.MutationEvent.ADDITION?null:e.prevValue;d(a,(function(e){if(e.attributes&&(!e.attributeFilter||!e.attributeFilter.length||-1!==e.attributeFilter.indexOf(o)||-1!==e.attributeFilter.indexOf(l)))return e.attributeOldValue?function(e){return r||((r=n.copy(i)).oldValue=e,r)}(v):s}));break;case t.ElementEvent.REMOVED:case t.ElementEvent.INSERTED:var c,h,f=e.target;e.type===t.ElementEvent.INSERTED?(c=[f],h=[]):(c=[],h=[f]);var b=f.previousSibling,E=f.nextSibling;(s=u("childList",a=e.relatedNode)).addedNodes=c,s.removedNodes=h,s.previousSibling=b,s.nextSibling=E,d(a,(function(e){if(e.childList)return s}))}i=r=void 0},e}();function u(e,t){return i=new n(e,t)}function d(e,t){for(var i=e;i;i=i.parentNode){var r=a.get(i);if(r)for(var n=0;r.length>n;n++){var s=r[n],o=s.options;if(i===e||o.subtree){var u=t(o);u&&s.enqueue(u)}}}}var l=!1,v=[];function c(){l=!1;var e=v;v=[],e.sort((function(e,t){return e.uid-t.uid}));var t=!1;e.forEach((function(e){var i=e.takeRecords();!function(e){e.nodes.forEach((function(t){var i=a.get(t);i&&i.forEach((function(t){t.observer===e&&t.removeTransientObservers()}))}))}(e),i.length&&(e.callback(i,e),t=!0)})),t&&c()}e.MutationObserver=function(){function e(e){this.callback=void 0,this.nodes=[],this.records=[],this.uid=s++,this.callback=e}var t=e.prototype;return t.observe=function(e,t){if(!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var i,r=a.get(e);r||a.set(e,r=[]);for(var n=0;r.length>n;n++)if(r[n].observer===this){(i=r[n]).removeListeners(),i.options=t;break}i||(i=new o(this,e,t),r.push(i),this.nodes.push(e)),i.addListeners()},t.disconnect=function(){var e=this;this.nodes.forEach((function(t){for(var i=a.get(t),r=0;i.length>r;r++){var n=i[r];if(n.observer===e){n.removeListeners(),i.splice(r,1);break}}}),this),this.records=[]},t.takeRecords=function(){var e=this.records;return this.records=[],e},e}(),e.MutationRecord=n,e.Registration=o,Object.defineProperty(e,"__esModule",{value:!0})}));
