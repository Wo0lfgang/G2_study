"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var util_1 = require("@antv/util");
var util_2 = require("../../../util");
var helper_1 = require("../utils/helper");
function adjustAngle(labels, overlapCfg, cfg, utils) {
    var _a = overlapCfg.optionalAngles, optionalAngles = _a === void 0 ? [0, 45, 90] : _a, margin = overlapCfg.margin, _b = overlapCfg.recoverWhenFailed, recoverWhenFailed = _b === void 0 ? true : _b;
    var defaultAngles = labels.map(function (label) { return +((0, util_2.getTransform)(label, 'rotate') || 0); });
    var runAndPassed = function () { return (0, helper_1.boundTest)(labels, margin).length < 1; };
    var setLabelsRotate = function (angle) {
        return labels.forEach(function (label, index) {
            var rotate = (0, util_1.isArray)(angle) ? angle[index] : angle;
            !(0, util_1.isNil)(rotate) && utils.rotate(label, rotate);
        });
    };
    if (runAndPassed())
        return;
    for (var i = 0; i < optionalAngles.length; i++) {
        setLabelsRotate(optionalAngles[i]);
        if (runAndPassed())
            return;
    }
    recoverWhenFailed && setLabelsRotate(defaultAngles);
}
exports.default = adjustAngle;
//# sourceMappingURL=autoRotate.js.map