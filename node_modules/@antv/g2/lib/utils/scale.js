"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.domainOf = exports.invert = exports.isOrdinalScale = void 0;
const d3_array_1 = require("d3-array");
function constrain(x, lo, hi) {
    return Math.min(hi, Math.max(lo, x));
}
function isOrdinalScale(scale) {
    return scale.getBandWidth;
}
exports.isOrdinalScale = isOrdinalScale;
function invert(scale, x, start) {
    if (!isOrdinalScale(scale))
        return scale.invert(x);
    const { adjustedRange } = scale;
    const { domain } = scale.getOptions();
    const offset = start ? -1 : 0;
    const step = scale.getStep();
    const range = start ? adjustedRange : adjustedRange.map((d) => d + step);
    // R[i0 - 1] < x <= R[i0]
    const i0 = (0, d3_array_1.bisectLeft)(range, x);
    const i1 = constrain(i0 + offset, 0, domain.length - 1);
    return domain[i1];
}
exports.invert = invert;
function domainOf(scale, values) {
    if (!isOrdinalScale(scale))
        return (0, d3_array_1.sort)(values);
    const { domain } = scale.getOptions();
    const [v1, v2] = values;
    const start = domain.indexOf(v1);
    const end = domain.indexOf(v2);
    return domain.slice(start, end + 1);
}
exports.domainOf = domainOf;
//# sourceMappingURL=scale.js.map